New As screen:

    Button2_Cancel As button:
        Fill: =RGBA(39, 113, 194, 1)
        OnSelect: =Navigate(Home)
        Text: ="Cancel"
        X: =997
        Y: =700
        ZIndex: =6

    Button2_Submit As button:
        Fill: =RGBA(39, 113, 194, 1)
        OnSelect: =Navigate(Detail)
        Text: ="Submit"
        X: =1183
        Y: =700
        ZIndex: =7

    Container2_Aprroval_Stage As groupContainer.manualLayoutContainer:
        Fill: =RGBA(240, 255, 255, 1)
        Height: =577
        Width: =648
        X: =695
        Y: =96
        ZIndex: =8

        "Gallery3 As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver5.0'":
            DelayItemLoading: =true
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height - Container2.Height
            Items: |-
                =If(
                    IsBlank(Dropdown2_Case.SelectedText),
                    Filter(
                        Expenditure_Approval,
                        Condition_Min < Value(TextInput4_Amount.Text) And Value(TextInput4_Amount.Text) < Condition_Max
                    ),
                    Filter(
                        Expenditure_Approval,
                        Dropdown2_Case.SelectedText.Value = Case
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateFill: |-
                =If(
                    Mod(ThisItem.rowNum,2) = 0,
                    RGBA(240, 240, 240, 1),RGBA(255, 255, 255, 1)
                )
            TemplatePadding: =0
            TemplateSize: =120
            Width: =Parent.Width
            Y: =70
            ZIndex: =1

            level As label:
                Align: =Align.Center
                FontWeight: =
                Height: =Gallery3.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Level
                ZIndex: =1

            type_of_approval As label:
                Align: =Align.Center
                FontWeight: =
                Height: =Gallery3.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Approve_Type.Value
                Width: =248
                X: =150
                ZIndex: =2

            text_person_in_charge As label:
                Align: =Align.Center
                FontWeight: =
                Height: =Gallery3.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: |-
                    =//ThisItem.Person_Approve
                    LookUp(BKIM_REQ_APPROVAL_PERSON_LIST,Department = Office365Users.UserProfile(User().Email).Department,Person.DisplayName)
                Visible: =false
                Width: =250
                X: =398
                ZIndex: =3

            "Gallery1 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =120
                Items: |-
                    =Filter(Expenditure_Approval,
                        //Lay nguoi duyet cap 1
                        If(level.Text = Level && Dropdown2_Case.Selected.Value = Case,
                        /*LookUp(BKIM_REQ_APPROVAL_PERSON_LIST,Department = Office365Users.UserProfile(User().Email).Department,Person.DisplayName)*/
                        Person_Approve
                        //Lay nguoi duyet cap 2
                    
                    
                        //Lay nguoi duyet cap 3
                    
                    
                        //Lay nguoi duyet cap 4
                    
                        )
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =120
                Width: =250
                X: =398
                ZIndex: =4

                Title2 As label:
                    FontWeight: |
                        =
                    Height: =45
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Person_Approve
                    VerticalAlign: =VerticalAlign.Top
                    Width: =216
                    X: =16
                    Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                    ZIndex: =1

                Separator2 As rectangle:
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - Self.Height
                    ZIndex: =3

            Separator4 As rectangle:
                Fill: =RGBA(39, 113, 194, 1)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =5

        Container2 As groupContainer.horizontalAutoLayoutContainer:
            Height: =70
            LayoutMode: =LayoutMode.Auto
            Width: =Parent.Width
            ZIndex: =2

            Label9_Level As label:
                Align: =Align.Center
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(39, 113, 194, 1)
                FontWeight: =FontWeight.Semibold
                Height: =Container2.Height
                Text: ="Level"
                ZIndex: =1

            Label9_type_approve As label:
                Align: =Align.Center
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(39, 113, 194, 1)
                FontWeight: =FontWeight.Semibold
                Height: =Container2.Height
                Text: ="Type of Approval"
                Width: =(Container2.Width - Label9_Level.Width)/2 
                ZIndex: =2

            Label9_person_in_charge As label:
                Align: =Align.Center
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(39, 113, 194, 1)
                FontWeight: =FontWeight.Semibold
                Height: =Container2.Height
                Text: ="Person in Charge"
                Width: =(Container2.Width - Label9_Level.Width)/2
                ZIndex: =3

    Header_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =8

        Rectangle6_1 As rectangle:
            BorderColor: =RGBA(102, 182, 227, 1)
            Fill: =RGBA(39, 113, 194, 1)
            Height: =70
            Width: =1366
            ZIndex: =1

        Label6_1 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =70
            Size: =16
            Text: ="New Request"
            Width: =1366
            ZIndex: =2

        Image7_1 As image:
            Height: =38
            Image: ='BKIM logo_clean_white'
            X: =20
            Y: =16
            ZIndex: =3

        Image9_1 As image:
            Height: =61
            Image: =User().Image
            RadiusBottomLeft: =100
            RadiusBottomRight: =100
            RadiusTopLeft: =100
            RadiusTopRight: =100
            Width: =61
            X: =1297
            Y: =4
            ZIndex: =4

        Label7_1 As label:
            Align: =Align.Right
            Color: =RGBA(255, 255, 255, 1)
            Height: =66
            Text: =User().FullName
            Width: =270
            X: =1020
            Y: =4
            ZIndex: =5

    Container_Input As groupContainer.manualLayoutContainer:
        Fill: =RGBA(240, 255, 255, 1)
        Height: =577
        Width: =648
        X: =20
        Y: =95
        ZIndex: =9

        Dropdown2_DoA As dropdown:
            Default: =
            Items: =["DoA_Type"]
            Width: =Parent.Width/2.2
            X: =16
            Y: =12
            ZIndex: =1

        TextInput4_Amount As text:
            Default: =""
            Height: =41
            HintText: ="Amount (VND)"
            Width: =Parent.Width/3.5
            X: =16
            Y: =73
            ZIndex: =2

        Dropdown2_Type As dropdown:
            Default: =
            Items: =Distinct(Expenditure_Approval,Type)
            Width: =Parent.Width/2.2
            X: =332
            Y: =12
            ZIndex: =3

        Dropdown2_Case As dropdown:
            Default: =
            Items: =Distinct(Filter(Expenditure_Approval, Condition_Min < Value(TextInput4_Amount.Text) And Value(TextInput4_Amount.Text) < Condition_Max),Case)
            Width: =Parent.Width/1.59
            X: =218
            Y: =73
            ZIndex: =4

        TextInput8_Title As text:
            Default: =""
            HintText: ="Title"
            Width: =611
            X: =16
            Y: =133
            ZIndex: =5

        TextInput8_1_Detail As text:
            Default: =""
            Height: =243
            HintText: ="Detail"
            Mode: =TextMode.MultiLine
            Width: =611
            X: =16
            Y: =195
            ZIndex: =6

        TextInput4_1_Attachment As text:
            Default: =""
            Height: =41
            HintText: ="File đính kèm"
            Visible: =false
            Width: =425
            X: =16
            Y: =455
            ZIndex: =7

        Button5 As button:
            Fill: =RGBA(39, 113, 194, 1)
            Height: =41
            OnSelect: |-
                =//Patch Request
                Patch(BKIM_REQ_List,
                {
                    Title:"Test"
                });
                
                //SharePoint Folder name
                Set(varSharePointLink,"Request_"&Last(BKIM_REQ_List).ID);
                
                //Gen new folder in sharepoint
                BKIM_REQ_SharePoint_GenFolder.Run(varSharePointLink);
                
                //Visible
                Set(boolSharePointVisible, false);
            Text: ="SharePoint"
            Visible: =boolSharePointVisible
            X: =17
            Y: =455
            ZIndex: =8

        Label9_Link As label:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =48
            OnSelect: |-
                =Launch("https://bkimsg.sharepoint.com/sites/BKIMCenter/Request%20Document/Forms/AllItems.aspx?id=%2Fsites%2FBKIMCenter%2FRequest%20Document%2F"&varSharePointLink)
            Text: |-
                ="SharePoint Folder: " & varSharePointLink
            Width: =257
            X: =16
            Y: =511
            ZIndex: =9

    Button6 As button:
        OnSelect: =Set(boolSharePointVisible,true)
        Text: ="Button"
        X: =20
        Y: =700
        ZIndex: =10

